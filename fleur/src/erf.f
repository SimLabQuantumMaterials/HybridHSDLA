      REAL FUNCTION erf(xx)
c     ************************************************************
c     error function
c     ************************************************************
C     .. Scalar Arguments ..
      REAL xx
C     ..
C     .. Local Scalars ..
      REAL a,r,sqpi,x,x2,xi2
      INTEGER i
C     ..
C     .. Local Arrays ..
      REAL p1(4),p2(6),p3(4),q1(4),q2(6),q3(4)
C     ..
C     .. Intrinsic Functions ..
      INTRINSIC abs,exp,sign
C     ..
C     .. Data statements ..
      DATA (p1(i),i=1,4)/242.6679552305318,21.97926161829415,
     +     6.996383488619136,-3.560984370181539e-2/,
     +     (q1(i),i=1,4)/215.0588758698612,91.16490540451490,
     +     15.08279763040779,1.0/, (p2(i),i=1,6)/22.898992851659,
     +     26.094746956075,14.571898596926,4.2677201070898,
     +     .56437160686381,-6.0858151959688e-6/,
     +     (q2(i),i=1,6)/22.898985749891,51.933570687552,
     +     50.273202863803,26.288795758761,7.5688482293618,1.0/,
     +     (p3(i),i=1,4)/-1.21308276389978e-2,-.1199039552681460,
     +     -.243911029488626,-3.24319519277746e-2/,
     +     (q3(i),i=1,4)/4.30026643452770e-2,.489552441961437,
     +     1.43771227937118,1.0/
      DATA sqpi/.564189583547756/
C     ..
      x = abs(xx)
      IF (x.GT.6.0) GO TO 30
      x2 = x*x
      IF (x.GT.4.0) GO TO 20
      IF (x.GT..46875) GO TO 10
      a = x* (p1(1)+x2* (p1(2)+x2* (p1(3)+x2*p1(4))))
      a = a/ (q1(1)+x2* (q1(2)+x2* (q1(3)+x2*q1(4))))
      IF (xx.LT.0.) a = -a
      erf = a
      GO TO 40
   10 a = exp(-x2)* (p2(1)+x* (p2(2)+x* (p2(3)+x* (p2(4)+x* (p2(5)+
     +    x*p2(6))))))
      a = a/ (q2(1)+x* (q2(2)+x* (q2(3)+x* (q2(4)+x* (q2(5)+x*q2(6))))))
      erf = sign((1.0-a),xx)
      GO TO 40
   20 xi2 = 1./x2
      r = xi2* (p3(1)+xi2* (p3(2)+xi2* (p3(3)+xi2*p3(4))))/
     +    (q3(1)+xi2* (q3(2)+xi2* (q3(3)+xi2*q3(4))))
      a = exp(-x2)* (sqpi+r)/x
      erf = sign((1.0-a),xx)
      GO TO 40
   30 CONTINUE
      erf = xx/x
   40 RETURN
      END
